#include <gtest/gtest.h>
#include <iostream>
#include <QString>
#include <pthread.h>
#include <QMutex>
#include <Inventor/Qt/SoQt.h>

#include "graspitCore.h"
#include <graspitApp.h>
#include "mainWindow.h"
#include "ivmgr.h"
#include "world.h"
#include "plannerdlg.h"
#include "quality.h"
#include "robot.h"
#include "qmDlg.h"
#include "grasp.h"
#include "collisionInterface.h"
#include "collisionStructures.h"
#include "collisionModel.h"
#include "Graspit/collisionAlgorithms.h"
#include "bBox.h"
#include "matrix.h"

#define SLOP 0.001

TEST(TEST_KINEMATIC_CHAIN, TEST_LINK_JACOBIAN_LINK_COORDS) {

    QString fileName = QString(QString(getenv("GRASPIT"))+QString("/worlds/") + QString("plannerMug.xml"));

    graspitCore->getMainWindow()->mUI->worldBox->setTitle(fileName);
    graspitCore->getWorld()->load(fileName);
    graspitCore->getMainWindow()->setMainWorld(graspitCore->getWorld());

    KinematicChain *c = graspitCore->getWorld()->getRobot(0)->getChain(0);
    Matrix J = c->linkJacobian(false);

    int numLinks = c->getNumLinks();
    //jacobian size is: numLinks * 6, numLinks * 6

//    for (int i =0; i < numLinks*6; i++)
//    {
//        for(int j=0; j< numLinks*6; j++)
//        {
//            std::cout << " ASSERT_NEAR(J.elem(" <<i<< ","<< j<<"), " << J.elem(i,j) << ", SLOP);";
//        }
//        std::cout << std::endl;
//    }

    ASSERT_NEAR(J.elem(0,0), 2.22045e-16, SLOP); ASSERT_NEAR(J.elem(0,1), 1, SLOP); ASSERT_NEAR(J.elem(0,2), 5.55112e-17, SLOP); ASSERT_NEAR(J.elem(0,3), 2.77556e-15, SLOP); ASSERT_NEAR(J.elem(0,4), -7.88861e-31, SLOP); ASSERT_NEAR(J.elem(0,5), 3.10862e-15, SLOP); ASSERT_NEAR(J.elem(0,6), 0, SLOP); ASSERT_NEAR(J.elem(0,7), 0, SLOP); ASSERT_NEAR(J.elem(0,8), 0, SLOP); ASSERT_NEAR(J.elem(0,9), 0, SLOP); ASSERT_NEAR(J.elem(0,10), 0, SLOP); ASSERT_NEAR(J.elem(0,11), 0, SLOP); ASSERT_NEAR(J.elem(0,12), 0, SLOP); ASSERT_NEAR(J.elem(0,13), 0, SLOP); ASSERT_NEAR(J.elem(0,14), 0, SLOP); ASSERT_NEAR(J.elem(0,15), 0, SLOP); ASSERT_NEAR(J.elem(0,16), 0, SLOP); ASSERT_NEAR(J.elem(0,17), 0, SLOP);
    ASSERT_NEAR(J.elem(1,0), -2.77556e-16, SLOP); ASSERT_NEAR(J.elem(1,1), 1.11022e-16, SLOP); ASSERT_NEAR(J.elem(1,2), -1, SLOP); ASSERT_NEAR(J.elem(1,3), -50, SLOP); ASSERT_NEAR(J.elem(1,4), 1.42109e-14, SLOP); ASSERT_NEAR(J.elem(1,5), 1.38778e-14, SLOP); ASSERT_NEAR(J.elem(1,6), 0, SLOP); ASSERT_NEAR(J.elem(1,7), 0, SLOP); ASSERT_NEAR(J.elem(1,8), 0, SLOP); ASSERT_NEAR(J.elem(1,9), 0, SLOP); ASSERT_NEAR(J.elem(1,10), 0, SLOP); ASSERT_NEAR(J.elem(1,11), 0, SLOP); ASSERT_NEAR(J.elem(1,12), 0, SLOP); ASSERT_NEAR(J.elem(1,13), 0, SLOP); ASSERT_NEAR(J.elem(1,14), 0, SLOP); ASSERT_NEAR(J.elem(1,15), 0, SLOP); ASSERT_NEAR(J.elem(1,16), 0, SLOP); ASSERT_NEAR(J.elem(1,17), 0, SLOP);
    ASSERT_NEAR(J.elem(2,0), -1, SLOP); ASSERT_NEAR(J.elem(2,1), 1.11022e-16, SLOP); ASSERT_NEAR(J.elem(2,2), 3.33067e-16, SLOP); ASSERT_NEAR(J.elem(2,3), 1.66533e-14, SLOP); ASSERT_NEAR(J.elem(2,4), -4.73317e-30, SLOP); ASSERT_NEAR(J.elem(2,5), 50, SLOP); ASSERT_NEAR(J.elem(2,6), 0, SLOP); ASSERT_NEAR(J.elem(2,7), 0, SLOP); ASSERT_NEAR(J.elem(2,8), 0, SLOP); ASSERT_NEAR(J.elem(2,9), 0, SLOP); ASSERT_NEAR(J.elem(2,10), 0, SLOP); ASSERT_NEAR(J.elem(2,11), 0, SLOP); ASSERT_NEAR(J.elem(2,12), 0, SLOP); ASSERT_NEAR(J.elem(2,13), 0, SLOP); ASSERT_NEAR(J.elem(2,14), 0, SLOP); ASSERT_NEAR(J.elem(2,15), 0, SLOP); ASSERT_NEAR(J.elem(2,16), 0, SLOP); ASSERT_NEAR(J.elem(2,17), 0, SLOP);
    ASSERT_NEAR(J.elem(3,0), 0, SLOP); ASSERT_NEAR(J.elem(3,1), 0, SLOP); ASSERT_NEAR(J.elem(3,2), 0, SLOP); ASSERT_NEAR(J.elem(3,3), 2.22045e-16, SLOP); ASSERT_NEAR(J.elem(3,4), 1, SLOP); ASSERT_NEAR(J.elem(3,5), 5.55112e-17, SLOP); ASSERT_NEAR(J.elem(3,6), 0, SLOP); ASSERT_NEAR(J.elem(3,7), 0, SLOP); ASSERT_NEAR(J.elem(3,8), 0, SLOP); ASSERT_NEAR(J.elem(3,9), 0, SLOP); ASSERT_NEAR(J.elem(3,10), 0, SLOP); ASSERT_NEAR(J.elem(3,11), 0, SLOP); ASSERT_NEAR(J.elem(3,12), 0, SLOP); ASSERT_NEAR(J.elem(3,13), 0, SLOP); ASSERT_NEAR(J.elem(3,14), 0, SLOP); ASSERT_NEAR(J.elem(3,15), 0, SLOP); ASSERT_NEAR(J.elem(3,16), 0, SLOP); ASSERT_NEAR(J.elem(3,17), 0, SLOP);
    ASSERT_NEAR(J.elem(4,0), 0, SLOP); ASSERT_NEAR(J.elem(4,1), 0, SLOP); ASSERT_NEAR(J.elem(4,2), 0, SLOP); ASSERT_NEAR(J.elem(4,3), -2.77556e-16, SLOP); ASSERT_NEAR(J.elem(4,4), 1.11022e-16, SLOP); ASSERT_NEAR(J.elem(4,5), -1, SLOP); ASSERT_NEAR(J.elem(4,6), 0, SLOP); ASSERT_NEAR(J.elem(4,7), 0, SLOP); ASSERT_NEAR(J.elem(4,8), 0, SLOP); ASSERT_NEAR(J.elem(4,9), 0, SLOP); ASSERT_NEAR(J.elem(4,10), 0, SLOP); ASSERT_NEAR(J.elem(4,11), 0, SLOP); ASSERT_NEAR(J.elem(4,12), 0, SLOP); ASSERT_NEAR(J.elem(4,13), 0, SLOP); ASSERT_NEAR(J.elem(4,14), 0, SLOP); ASSERT_NEAR(J.elem(4,15), 0, SLOP); ASSERT_NEAR(J.elem(4,16), 0, SLOP); ASSERT_NEAR(J.elem(4,17), 0, SLOP);
    ASSERT_NEAR(J.elem(5,0), 0, SLOP); ASSERT_NEAR(J.elem(5,1), 0, SLOP); ASSERT_NEAR(J.elem(5,2), 0, SLOP); ASSERT_NEAR(J.elem(5,3), -1, SLOP); ASSERT_NEAR(J.elem(5,4), 1.11022e-16, SLOP); ASSERT_NEAR(J.elem(5,5), 3.33067e-16, SLOP); ASSERT_NEAR(J.elem(5,6), 0, SLOP); ASSERT_NEAR(J.elem(5,7), 0, SLOP); ASSERT_NEAR(J.elem(5,8), 0, SLOP); ASSERT_NEAR(J.elem(5,9), 0, SLOP); ASSERT_NEAR(J.elem(5,10), 0, SLOP); ASSERT_NEAR(J.elem(5,11), 0, SLOP); ASSERT_NEAR(J.elem(5,12), 0, SLOP); ASSERT_NEAR(J.elem(5,13), 0, SLOP); ASSERT_NEAR(J.elem(5,14), 0, SLOP); ASSERT_NEAR(J.elem(5,15), 0, SLOP); ASSERT_NEAR(J.elem(5,16), 0, SLOP); ASSERT_NEAR(J.elem(5,17), 0, SLOP);
    ASSERT_NEAR(J.elem(6,0), 2.22045e-16, SLOP); ASSERT_NEAR(J.elem(6,1), 0.996195, SLOP); ASSERT_NEAR(J.elem(6,2), -0.0871557, SLOP); ASSERT_NEAR(J.elem(6,3), -4.35779, SLOP); ASSERT_NEAR(J.elem(6,4), 1.12244e-15, SLOP); ASSERT_NEAR(J.elem(6,5), 1.72735e-15, SLOP); ASSERT_NEAR(J.elem(6,6), 0.996195, SLOP); ASSERT_NEAR(J.elem(6,7), 0.0871557, SLOP); ASSERT_NEAR(J.elem(6,8), 1.10917e-16, SLOP); ASSERT_NEAR(J.elem(6,9), 5.74127e-17, SLOP); ASSERT_NEAR(J.elem(6,10), -6.5623e-16, SLOP); ASSERT_NEAR(J.elem(6,11), -1.24345e-14, SLOP); ASSERT_NEAR(J.elem(6,12), 0, SLOP); ASSERT_NEAR(J.elem(6,13), 0, SLOP); ASSERT_NEAR(J.elem(6,14), 0, SLOP); ASSERT_NEAR(J.elem(6,15), 0, SLOP); ASSERT_NEAR(J.elem(6,16), 0, SLOP); ASSERT_NEAR(J.elem(6,17), 0, SLOP);
    ASSERT_NEAR(J.elem(7,0), -3.33067e-16, SLOP); ASSERT_NEAR(J.elem(7,1), -0.0871557, SLOP); ASSERT_NEAR(J.elem(7,2), -0.996195, SLOP); ASSERT_NEAR(J.elem(7,3), -119.81, SLOP); ASSERT_NEAR(J.elem(7,4), 3.03456e-14, SLOP); ASSERT_NEAR(J.elem(7,5), 3.74022e-14, SLOP); ASSERT_NEAR(J.elem(7,6), -0.0871557, SLOP); ASSERT_NEAR(J.elem(7,7), 0.996195, SLOP); ASSERT_NEAR(J.elem(7,8), -4.84272e-18, SLOP); ASSERT_NEAR(J.elem(7,9), -7.10793e-15, SLOP); ASSERT_NEAR(J.elem(7,10), -2.81578e-16, SLOP); ASSERT_NEAR(J.elem(7,11), 70, SLOP); ASSERT_NEAR(J.elem(7,12), 0, SLOP); ASSERT_NEAR(J.elem(7,13), 0, SLOP); ASSERT_NEAR(J.elem(7,14), 0, SLOP); ASSERT_NEAR(J.elem(7,15), 0, SLOP); ASSERT_NEAR(J.elem(7,16), 0, SLOP); ASSERT_NEAR(J.elem(7,17), 0, SLOP);
    ASSERT_NEAR(J.elem(8,0), -1, SLOP); ASSERT_NEAR(J.elem(8,1), 3.33067e-16, SLOP); ASSERT_NEAR(J.elem(8,2), 2.22045e-16, SLOP); ASSERT_NEAR(J.elem(8,3), 2.86182e-14, SLOP); ASSERT_NEAR(J.elem(8,4), 6.1009, SLOP); ASSERT_NEAR(J.elem(8,5), 119.734, SLOP); ASSERT_NEAR(J.elem(8,6), -1.10917e-16, SLOP); ASSERT_NEAR(J.elem(8,7), -4.84272e-18, SLOP); ASSERT_NEAR(J.elem(8,8), 1, SLOP); ASSERT_NEAR(J.elem(8,9), 6.1009, SLOP); ASSERT_NEAR(J.elem(8,10), -69.7336, SLOP); ASSERT_NEAR(J.elem(8,11), 3.38991e-16, SLOP); ASSERT_NEAR(J.elem(8,12), 0, SLOP); ASSERT_NEAR(J.elem(8,13), 0, SLOP); ASSERT_NEAR(J.elem(8,14), 0, SLOP); ASSERT_NEAR(J.elem(8,15), 0, SLOP); ASSERT_NEAR(J.elem(8,16), 0, SLOP); ASSERT_NEAR(J.elem(8,17), 0, SLOP);
    ASSERT_NEAR(J.elem(9,0), 0, SLOP); ASSERT_NEAR(J.elem(9,1), 0, SLOP); ASSERT_NEAR(J.elem(9,2), 0, SLOP); ASSERT_NEAR(J.elem(9,3), 2.22045e-16, SLOP); ASSERT_NEAR(J.elem(9,4), 0.996195, SLOP); ASSERT_NEAR(J.elem(9,5), -0.0871557, SLOP); ASSERT_NEAR(J.elem(9,6), 0, SLOP); ASSERT_NEAR(J.elem(9,7), 0, SLOP); ASSERT_NEAR(J.elem(9,8), 0, SLOP); ASSERT_NEAR(J.elem(9,9), 0.996195, SLOP); ASSERT_NEAR(J.elem(9,10), 0.0871557, SLOP); ASSERT_NEAR(J.elem(9,11), 1.10917e-16, SLOP); ASSERT_NEAR(J.elem(9,12), 0, SLOP); ASSERT_NEAR(J.elem(9,13), 0, SLOP); ASSERT_NEAR(J.elem(9,14), 0, SLOP); ASSERT_NEAR(J.elem(9,15), 0, SLOP); ASSERT_NEAR(J.elem(9,16), 0, SLOP); ASSERT_NEAR(J.elem(9,17), 0, SLOP);
    ASSERT_NEAR(J.elem(10,0), 0, SLOP); ASSERT_NEAR(J.elem(10,1), 0, SLOP); ASSERT_NEAR(J.elem(10,2), 0, SLOP); ASSERT_NEAR(J.elem(10,3), -3.33067e-16, SLOP); ASSERT_NEAR(J.elem(10,4), -0.0871557, SLOP); ASSERT_NEAR(J.elem(10,5), -0.996195, SLOP); ASSERT_NEAR(J.elem(10,6), 0, SLOP); ASSERT_NEAR(J.elem(10,7), 0, SLOP); ASSERT_NEAR(J.elem(10,8), 0, SLOP); ASSERT_NEAR(J.elem(10,9), -0.0871557, SLOP); ASSERT_NEAR(J.elem(10,10), 0.996195, SLOP); ASSERT_NEAR(J.elem(10,11), -4.84272e-18, SLOP); ASSERT_NEAR(J.elem(10,12), 0, SLOP); ASSERT_NEAR(J.elem(10,13), 0, SLOP); ASSERT_NEAR(J.elem(10,14), 0, SLOP); ASSERT_NEAR(J.elem(10,15), 0, SLOP); ASSERT_NEAR(J.elem(10,16), 0, SLOP); ASSERT_NEAR(J.elem(10,17), 0, SLOP);
    ASSERT_NEAR(J.elem(11,0), 0, SLOP); ASSERT_NEAR(J.elem(11,1), 0, SLOP); ASSERT_NEAR(J.elem(11,2), 0, SLOP); ASSERT_NEAR(J.elem(11,3), -1, SLOP); ASSERT_NEAR(J.elem(11,4), 3.33067e-16, SLOP); ASSERT_NEAR(J.elem(11,5), 2.22045e-16, SLOP); ASSERT_NEAR(J.elem(11,6), 0, SLOP); ASSERT_NEAR(J.elem(11,7), 0, SLOP); ASSERT_NEAR(J.elem(11,8), 0, SLOP); ASSERT_NEAR(J.elem(11,9), -1.10917e-16, SLOP); ASSERT_NEAR(J.elem(11,10), -4.84272e-18, SLOP); ASSERT_NEAR(J.elem(11,11), 1, SLOP); ASSERT_NEAR(J.elem(11,12), 0, SLOP); ASSERT_NEAR(J.elem(11,13), 0, SLOP); ASSERT_NEAR(J.elem(11,14), 0, SLOP); ASSERT_NEAR(J.elem(11,15), 0, SLOP); ASSERT_NEAR(J.elem(11,16), 0, SLOP); ASSERT_NEAR(J.elem(11,17), 0, SLOP);
    ASSERT_NEAR(J.elem(12,0), 0, SLOP); ASSERT_NEAR(J.elem(12,1), 0.707107, SLOP); ASSERT_NEAR(J.elem(12,2), -0.707107, SLOP); ASSERT_NEAR(J.elem(12,3), -80.3505, SLOP); ASSERT_NEAR(J.elem(12,4), 1.7585e-14, SLOP); ASSERT_NEAR(J.elem(12,5), 1.7585e-14, SLOP); ASSERT_NEAR(J.elem(12,6), 0.707107, SLOP); ASSERT_NEAR(J.elem(12,7), 0.707107, SLOP); ASSERT_NEAR(J.elem(12,8), 2.12432e-17, SLOP); ASSERT_NEAR(J.elem(12,9), -9.09282e-15, SLOP); ASSERT_NEAR(J.elem(12,10), 7.74106e-15, SLOP); ASSERT_NEAR(J.elem(12,11), 44.9951, SLOP); ASSERT_NEAR(J.elem(12,12), 0.766044, SLOP); ASSERT_NEAR(J.elem(12,13), 0.642788, SLOP); ASSERT_NEAR(J.elem(12,14), -1.04327e-16, SLOP); ASSERT_NEAR(J.elem(12,15), -3.6883e-15, SLOP); ASSERT_NEAR(J.elem(12,16), 4.39554e-15, SLOP); ASSERT_NEAR(J.elem(12,17), -1.06581e-14, SLOP);
    ASSERT_NEAR(J.elem(13,0), -2.77556e-16, SLOP); ASSERT_NEAR(J.elem(13,1), -0.707107, SLOP); ASSERT_NEAR(J.elem(13,2), -0.707107, SLOP); ASSERT_NEAR(J.elem(13,3), -143.978, SLOP); ASSERT_NEAR(J.elem(13,4), 3.00728e-14, SLOP); ASSERT_NEAR(J.elem(13,5), 2.64421e-14, SLOP); ASSERT_NEAR(J.elem(13,6), -0.707107, SLOP); ASSERT_NEAR(J.elem(13,7), 0.707107, SLOP); ASSERT_NEAR(J.elem(13,8), 5.12856e-17, SLOP); ASSERT_NEAR(J.elem(13,9), -7.74116e-15, SLOP); ASSERT_NEAR(J.elem(13,10), -1.56195e-14, SLOP); ASSERT_NEAR(J.elem(13,11), 108.623, SLOP); ASSERT_NEAR(J.elem(13,12), -0.642788, SLOP); ASSERT_NEAR(J.elem(13,13), 0.766044, SLOP); ASSERT_NEAR(J.elem(13,14), 3.79719e-17, SLOP); ASSERT_NEAR(J.elem(13,15), 1.34243e-15, SLOP); ASSERT_NEAR(J.elem(13,16), -1.59985e-15, SLOP); ASSERT_NEAR(J.elem(13,17), 55, SLOP);
    ASSERT_NEAR(J.elem(14,0), -1, SLOP); ASSERT_NEAR(J.elem(14,1), 2.77556e-16, SLOP); ASSERT_NEAR(J.elem(14,2), 0, SLOP); ASSERT_NEAR(J.elem(14,3), 1.24877e-14, SLOP); ASSERT_NEAR(J.elem(14,4), 44.9918, SLOP); ASSERT_NEAR(J.elem(14,5), 158.625, SLOP); ASSERT_NEAR(J.elem(14,6), 2.12432e-17, SLOP); ASSERT_NEAR(J.elem(14,7), -5.12856e-17, SLOP); ASSERT_NEAR(J.elem(14,8), 1, SLOP); ASSERT_NEAR(J.elem(14,9), 44.9918, SLOP); ASSERT_NEAR(J.elem(14,10), -108.625, SLOP); ASSERT_NEAR(J.elem(14,11), -6.52664e-15, SLOP); ASSERT_NEAR(J.elem(14,12), 1.04327e-16, SLOP); ASSERT_NEAR(J.elem(14,13), 3.79719e-17, SLOP); ASSERT_NEAR(J.elem(14,14), 1, SLOP); ASSERT_NEAR(J.elem(14,15), 35.3533, SLOP); ASSERT_NEAR(J.elem(14,16), -42.1324, SLOP); ASSERT_NEAR(J.elem(14,17), -2.08845e-15, SLOP);
    ASSERT_NEAR(J.elem(15,0), 0, SLOP); ASSERT_NEAR(J.elem(15,1), 0, SLOP); ASSERT_NEAR(J.elem(15,2), 0, SLOP); ASSERT_NEAR(J.elem(15,3), 0, SLOP); ASSERT_NEAR(J.elem(15,4), 0.707107, SLOP); ASSERT_NEAR(J.elem(15,5), -0.707107, SLOP); ASSERT_NEAR(J.elem(15,6), 0, SLOP); ASSERT_NEAR(J.elem(15,7), 0, SLOP); ASSERT_NEAR(J.elem(15,8), 0, SLOP); ASSERT_NEAR(J.elem(15,9), 0.707107, SLOP); ASSERT_NEAR(J.elem(15,10), 0.707107, SLOP); ASSERT_NEAR(J.elem(15,11), 2.12432e-17, SLOP); ASSERT_NEAR(J.elem(15,12), 0, SLOP); ASSERT_NEAR(J.elem(15,13), 0, SLOP); ASSERT_NEAR(J.elem(15,14), 0, SLOP); ASSERT_NEAR(J.elem(15,15), 0.766044, SLOP); ASSERT_NEAR(J.elem(15,16), 0.642788, SLOP); ASSERT_NEAR(J.elem(15,17), -1.04327e-16, SLOP);
    ASSERT_NEAR(J.elem(16,0), 0, SLOP); ASSERT_NEAR(J.elem(16,1), 0, SLOP); ASSERT_NEAR(J.elem(16,2), 0, SLOP); ASSERT_NEAR(J.elem(16,3), -2.77556e-16, SLOP); ASSERT_NEAR(J.elem(16,4), -0.707107, SLOP); ASSERT_NEAR(J.elem(16,5), -0.707107, SLOP); ASSERT_NEAR(J.elem(16,6), 0, SLOP); ASSERT_NEAR(J.elem(16,7), 0, SLOP); ASSERT_NEAR(J.elem(16,8), 0, SLOP); ASSERT_NEAR(J.elem(16,9), -0.707107, SLOP); ASSERT_NEAR(J.elem(16,10), 0.707107, SLOP); ASSERT_NEAR(J.elem(16,11), 5.12856e-17, SLOP); ASSERT_NEAR(J.elem(16,12), 0, SLOP); ASSERT_NEAR(J.elem(16,13), 0, SLOP); ASSERT_NEAR(J.elem(16,14), 0, SLOP); ASSERT_NEAR(J.elem(16,15), -0.642788, SLOP); ASSERT_NEAR(J.elem(16,16), 0.766044, SLOP); ASSERT_NEAR(J.elem(16,17), 3.79719e-17, SLOP);
    ASSERT_NEAR(J.elem(17,0), 0, SLOP); ASSERT_NEAR(J.elem(17,1), 0, SLOP); ASSERT_NEAR(J.elem(17,2), 0, SLOP); ASSERT_NEAR(J.elem(17,3), -1, SLOP); ASSERT_NEAR(J.elem(17,4), 2.77556e-16, SLOP); ASSERT_NEAR(J.elem(17,5), 0, SLOP); ASSERT_NEAR(J.elem(17,6), 0, SLOP); ASSERT_NEAR(J.elem(17,7), 0, SLOP); ASSERT_NEAR(J.elem(17,8), 0, SLOP); ASSERT_NEAR(J.elem(17,9), 2.12432e-17, SLOP); ASSERT_NEAR(J.elem(17,10), -5.12856e-17, SLOP); ASSERT_NEAR(J.elem(17,11), 1, SLOP); ASSERT_NEAR(J.elem(17,12), 0, SLOP); ASSERT_NEAR(J.elem(17,13), 0, SLOP); ASSERT_NEAR(J.elem(17,14), 0, SLOP); ASSERT_NEAR(J.elem(17,15), 1.04327e-16, SLOP); ASSERT_NEAR(J.elem(17,16), 3.79719e-17, SLOP); ASSERT_NEAR(J.elem(17,17), 1, SLOP);

}
TEST(TEST_KINEMATIC_CHAIN, TEST_LINK_JACOBIAN_WORLD_COORDS) {

    QString fileName = QString(QString(getenv("GRASPIT"))+QString("/worlds/") + QString("plannerMug.xml"));

    graspitCore->getMainWindow()->mUI->worldBox->setTitle(fileName);
    graspitCore->getWorld()->load(fileName);
    graspitCore->getMainWindow()->setMainWorld(graspitCore->getWorld());

    KinematicChain *c = graspitCore->getWorld()->getRobot(0)->getChain(0);

    int numLinks = c->getNumLinks();
    Matrix J2 = c->linkJacobian(true);


//        for (int i =0; i < numLinks*6; i++)
//        {
//            for(int j=0; j< numLinks*6; j++)
//            {
//                std::cout << " ASSERT_NEAR(J2.elem(" <<i<< ","<< j<<"), " << J2.elem(i,j) << ", SLOP);";
//            }
//            std::cout << std::endl;
//        }

        ASSERT_NEAR(J2.elem(0,0), -1, SLOP); ASSERT_NEAR(J2.elem(0,1), 0, SLOP); ASSERT_NEAR(J2.elem(0,2), 1.22465e-16, SLOP); ASSERT_NEAR(J2.elem(0,3), 6.12323e-15, SLOP); ASSERT_NEAR(J2.elem(0,4), -1.74033e-30, SLOP); ASSERT_NEAR(J2.elem(0,5), 50, SLOP); ASSERT_NEAR(J2.elem(0,6), 0, SLOP); ASSERT_NEAR(J2.elem(0,7), 0, SLOP); ASSERT_NEAR(J2.elem(0,8), 0, SLOP); ASSERT_NEAR(J2.elem(0,9), 0, SLOP); ASSERT_NEAR(J2.elem(0,10), 0, SLOP); ASSERT_NEAR(J2.elem(0,11), 0, SLOP); ASSERT_NEAR(J2.elem(0,12), 0, SLOP); ASSERT_NEAR(J2.elem(0,13), 0, SLOP); ASSERT_NEAR(J2.elem(0,14), 0, SLOP); ASSERT_NEAR(J2.elem(0,15), 0, SLOP); ASSERT_NEAR(J2.elem(0,16), 0, SLOP); ASSERT_NEAR(J2.elem(0,17), 0, SLOP);
         ASSERT_NEAR(J2.elem(1,0), -0, SLOP); ASSERT_NEAR(J2.elem(1,1), 1, SLOP); ASSERT_NEAR(J2.elem(1,2), 0, SLOP); ASSERT_NEAR(J2.elem(1,3), 0, SLOP); ASSERT_NEAR(J2.elem(1,4), -0, SLOP); ASSERT_NEAR(J2.elem(1,5), 1.42109e-14, SLOP); ASSERT_NEAR(J2.elem(1,6), 0, SLOP); ASSERT_NEAR(J2.elem(1,7), 0, SLOP); ASSERT_NEAR(J2.elem(1,8), 0, SLOP); ASSERT_NEAR(J2.elem(1,9), 0, SLOP); ASSERT_NEAR(J2.elem(1,10), 0, SLOP); ASSERT_NEAR(J2.elem(1,11), 0, SLOP); ASSERT_NEAR(J2.elem(1,12), 0, SLOP); ASSERT_NEAR(J2.elem(1,13), 0, SLOP); ASSERT_NEAR(J2.elem(1,14), 0, SLOP); ASSERT_NEAR(J2.elem(1,15), 0, SLOP); ASSERT_NEAR(J2.elem(1,16), 0, SLOP); ASSERT_NEAR(J2.elem(1,17), 0, SLOP);
         ASSERT_NEAR(J2.elem(2,0), -1.22465e-16, SLOP); ASSERT_NEAR(J2.elem(2,1), -0, SLOP); ASSERT_NEAR(J2.elem(2,2), -1, SLOP); ASSERT_NEAR(J2.elem(2,3), -50, SLOP); ASSERT_NEAR(J2.elem(2,4), 1.42109e-14, SLOP); ASSERT_NEAR(J2.elem(2,5), 6.12323e-15, SLOP); ASSERT_NEAR(J2.elem(2,6), 0, SLOP); ASSERT_NEAR(J2.elem(2,7), 0, SLOP); ASSERT_NEAR(J2.elem(2,8), 0, SLOP); ASSERT_NEAR(J2.elem(2,9), 0, SLOP); ASSERT_NEAR(J2.elem(2,10), 0, SLOP); ASSERT_NEAR(J2.elem(2,11), 0, SLOP); ASSERT_NEAR(J2.elem(2,12), 0, SLOP); ASSERT_NEAR(J2.elem(2,13), 0, SLOP); ASSERT_NEAR(J2.elem(2,14), 0, SLOP); ASSERT_NEAR(J2.elem(2,15), 0, SLOP); ASSERT_NEAR(J2.elem(2,16), 0, SLOP); ASSERT_NEAR(J2.elem(2,17), 0, SLOP);
         ASSERT_NEAR(J2.elem(3,0), 0, SLOP); ASSERT_NEAR(J2.elem(3,1), 0, SLOP); ASSERT_NEAR(J2.elem(3,2), 0, SLOP); ASSERT_NEAR(J2.elem(3,3), -1, SLOP); ASSERT_NEAR(J2.elem(3,4), 0, SLOP); ASSERT_NEAR(J2.elem(3,5), 1.22465e-16, SLOP); ASSERT_NEAR(J2.elem(3,6), 0, SLOP); ASSERT_NEAR(J2.elem(3,7), 0, SLOP); ASSERT_NEAR(J2.elem(3,8), 0, SLOP); ASSERT_NEAR(J2.elem(3,9), 0, SLOP); ASSERT_NEAR(J2.elem(3,10), 0, SLOP); ASSERT_NEAR(J2.elem(3,11), 0, SLOP); ASSERT_NEAR(J2.elem(3,12), 0, SLOP); ASSERT_NEAR(J2.elem(3,13), 0, SLOP); ASSERT_NEAR(J2.elem(3,14), 0, SLOP); ASSERT_NEAR(J2.elem(3,15), 0, SLOP); ASSERT_NEAR(J2.elem(3,16), 0, SLOP); ASSERT_NEAR(J2.elem(3,17), 0, SLOP);
         ASSERT_NEAR(J2.elem(4,0), 0, SLOP); ASSERT_NEAR(J2.elem(4,1), 0, SLOP); ASSERT_NEAR(J2.elem(4,2), 0, SLOP); ASSERT_NEAR(J2.elem(4,3), -0, SLOP); ASSERT_NEAR(J2.elem(4,4), 1, SLOP); ASSERT_NEAR(J2.elem(4,5), 0, SLOP); ASSERT_NEAR(J2.elem(4,6), 0, SLOP); ASSERT_NEAR(J2.elem(4,7), 0, SLOP); ASSERT_NEAR(J2.elem(4,8), 0, SLOP); ASSERT_NEAR(J2.elem(4,9), 0, SLOP); ASSERT_NEAR(J2.elem(4,10), 0, SLOP); ASSERT_NEAR(J2.elem(4,11), 0, SLOP); ASSERT_NEAR(J2.elem(4,12), 0, SLOP); ASSERT_NEAR(J2.elem(4,13), 0, SLOP); ASSERT_NEAR(J2.elem(4,14), 0, SLOP); ASSERT_NEAR(J2.elem(4,15), 0, SLOP); ASSERT_NEAR(J2.elem(4,16), 0, SLOP); ASSERT_NEAR(J2.elem(4,17), 0, SLOP);
         ASSERT_NEAR(J2.elem(5,0), 0, SLOP); ASSERT_NEAR(J2.elem(5,1), 0, SLOP); ASSERT_NEAR(J2.elem(5,2), 0, SLOP); ASSERT_NEAR(J2.elem(5,3), -1.22465e-16, SLOP); ASSERT_NEAR(J2.elem(5,4), -0, SLOP); ASSERT_NEAR(J2.elem(5,5), -1, SLOP); ASSERT_NEAR(J2.elem(5,6), 0, SLOP); ASSERT_NEAR(J2.elem(5,7), 0, SLOP); ASSERT_NEAR(J2.elem(5,8), 0, SLOP); ASSERT_NEAR(J2.elem(5,9), 0, SLOP); ASSERT_NEAR(J2.elem(5,10), 0, SLOP); ASSERT_NEAR(J2.elem(5,11), 0, SLOP); ASSERT_NEAR(J2.elem(5,12), 0, SLOP); ASSERT_NEAR(J2.elem(5,13), 0, SLOP); ASSERT_NEAR(J2.elem(5,14), 0, SLOP); ASSERT_NEAR(J2.elem(5,15), 0, SLOP); ASSERT_NEAR(J2.elem(5,16), 0, SLOP); ASSERT_NEAR(J2.elem(5,17), 0, SLOP);
         ASSERT_NEAR(J2.elem(6,0), -1, SLOP); ASSERT_NEAR(J2.elem(6,1), 0, SLOP); ASSERT_NEAR(J2.elem(6,2), 1.22465e-16, SLOP); ASSERT_NEAR(J2.elem(6,3), 1.46631e-14, SLOP); ASSERT_NEAR(J2.elem(6,4), 6.1009, SLOP); ASSERT_NEAR(J2.elem(6,5), 119.734, SLOP); ASSERT_NEAR(J2.elem(6,6), -2.22045e-16, SLOP); ASSERT_NEAR(J2.elem(6,7), 5.55112e-17, SLOP); ASSERT_NEAR(J2.elem(6,8), 1, SLOP); ASSERT_NEAR(J2.elem(6,9), 6.1009, SLOP); ASSERT_NEAR(J2.elem(6,10), -69.7336, SLOP); ASSERT_NEAR(J2.elem(6,11), 5.22567e-15, SLOP); ASSERT_NEAR(J2.elem(6,12), 0, SLOP); ASSERT_NEAR(J2.elem(6,13), 0, SLOP); ASSERT_NEAR(J2.elem(6,14), 0, SLOP); ASSERT_NEAR(J2.elem(6,15), 0, SLOP); ASSERT_NEAR(J2.elem(6,16), 0, SLOP); ASSERT_NEAR(J2.elem(6,17), 0, SLOP);
         ASSERT_NEAR(J2.elem(7,0), -0, SLOP); ASSERT_NEAR(J2.elem(7,1), 1, SLOP); ASSERT_NEAR(J2.elem(7,2), 0, SLOP); ASSERT_NEAR(J2.elem(7,3), 6.1009, SLOP); ASSERT_NEAR(J2.elem(7,4), 0, SLOP); ASSERT_NEAR(J2.elem(7,5), 2.84217e-14, SLOP); ASSERT_NEAR(J2.elem(7,6), 1, SLOP); ASSERT_NEAR(J2.elem(7,7), 1.11022e-16, SLOP); ASSERT_NEAR(J2.elem(7,8), 2.22045e-16, SLOP); ASSERT_NEAR(J2.elem(7,9), 1.35467e-15, SLOP); ASSERT_NEAR(J2.elem(7,10), -8.37855e-15, SLOP); ASSERT_NEAR(J2.elem(7,11), -6.1009, SLOP); ASSERT_NEAR(J2.elem(7,12), 0, SLOP); ASSERT_NEAR(J2.elem(7,13), 0, SLOP); ASSERT_NEAR(J2.elem(7,14), 0, SLOP); ASSERT_NEAR(J2.elem(7,15), 0, SLOP); ASSERT_NEAR(J2.elem(7,16), 0, SLOP); ASSERT_NEAR(J2.elem(7,17), 0, SLOP);
         ASSERT_NEAR(J2.elem(8,0), -1.22465e-16, SLOP); ASSERT_NEAR(J2.elem(8,1), -0, SLOP); ASSERT_NEAR(J2.elem(8,2), -1, SLOP); ASSERT_NEAR(J2.elem(8,3), -119.734, SLOP); ASSERT_NEAR(J2.elem(8,4), 2.91689e-14, SLOP); ASSERT_NEAR(J2.elem(8,5), 1.46631e-14, SLOP); ASSERT_NEAR(J2.elem(8,6), -5.55112e-17, SLOP); ASSERT_NEAR(J2.elem(8,7), 1, SLOP); ASSERT_NEAR(J2.elem(8,8), 0, SLOP); ASSERT_NEAR(J2.elem(8,9), -7.10543e-15, SLOP); ASSERT_NEAR(J2.elem(8,10), -3.9443e-31, SLOP); ASSERT_NEAR(J2.elem(8,11), 69.7336, SLOP); ASSERT_NEAR(J2.elem(8,12), 0, SLOP); ASSERT_NEAR(J2.elem(8,13), 0, SLOP); ASSERT_NEAR(J2.elem(8,14), 0, SLOP); ASSERT_NEAR(J2.elem(8,15), 0, SLOP); ASSERT_NEAR(J2.elem(8,16), 0, SLOP); ASSERT_NEAR(J2.elem(8,17), 0, SLOP);
         ASSERT_NEAR(J2.elem(9,0), 0, SLOP); ASSERT_NEAR(J2.elem(9,1), 0, SLOP); ASSERT_NEAR(J2.elem(9,2), 0, SLOP); ASSERT_NEAR(J2.elem(9,3), -1, SLOP); ASSERT_NEAR(J2.elem(9,4), 0, SLOP); ASSERT_NEAR(J2.elem(9,5), 1.22465e-16, SLOP); ASSERT_NEAR(J2.elem(9,6), 0, SLOP); ASSERT_NEAR(J2.elem(9,7), 0, SLOP); ASSERT_NEAR(J2.elem(9,8), 0, SLOP); ASSERT_NEAR(J2.elem(9,9), -2.22045e-16, SLOP); ASSERT_NEAR(J2.elem(9,10), 5.55112e-17, SLOP); ASSERT_NEAR(J2.elem(9,11), 1, SLOP); ASSERT_NEAR(J2.elem(9,12), 0, SLOP); ASSERT_NEAR(J2.elem(9,13), 0, SLOP); ASSERT_NEAR(J2.elem(9,14), 0, SLOP); ASSERT_NEAR(J2.elem(9,15), 0, SLOP); ASSERT_NEAR(J2.elem(9,16), 0, SLOP); ASSERT_NEAR(J2.elem(9,17), 0, SLOP);
         ASSERT_NEAR(J2.elem(10,0), 0, SLOP); ASSERT_NEAR(J2.elem(10,1), 0, SLOP); ASSERT_NEAR(J2.elem(10,2), 0, SLOP); ASSERT_NEAR(J2.elem(10,3), -0, SLOP); ASSERT_NEAR(J2.elem(10,4), 1, SLOP); ASSERT_NEAR(J2.elem(10,5), 0, SLOP); ASSERT_NEAR(J2.elem(10,6), 0, SLOP); ASSERT_NEAR(J2.elem(10,7), 0, SLOP); ASSERT_NEAR(J2.elem(10,8), 0, SLOP); ASSERT_NEAR(J2.elem(10,9), 1, SLOP); ASSERT_NEAR(J2.elem(10,10), 1.11022e-16, SLOP); ASSERT_NEAR(J2.elem(10,11), 2.22045e-16, SLOP); ASSERT_NEAR(J2.elem(10,12), 0, SLOP); ASSERT_NEAR(J2.elem(10,13), 0, SLOP); ASSERT_NEAR(J2.elem(10,14), 0, SLOP); ASSERT_NEAR(J2.elem(10,15), 0, SLOP); ASSERT_NEAR(J2.elem(10,16), 0, SLOP); ASSERT_NEAR(J2.elem(10,17), 0, SLOP);
         ASSERT_NEAR(J2.elem(11,0), 0, SLOP); ASSERT_NEAR(J2.elem(11,1), 0, SLOP); ASSERT_NEAR(J2.elem(11,2), 0, SLOP); ASSERT_NEAR(J2.elem(11,3), -1.22465e-16, SLOP); ASSERT_NEAR(J2.elem(11,4), -0, SLOP); ASSERT_NEAR(J2.elem(11,5), -1, SLOP); ASSERT_NEAR(J2.elem(11,6), 0, SLOP); ASSERT_NEAR(J2.elem(11,7), 0, SLOP); ASSERT_NEAR(J2.elem(11,8), 0, SLOP); ASSERT_NEAR(J2.elem(11,9), -5.55112e-17, SLOP); ASSERT_NEAR(J2.elem(11,10), 1, SLOP); ASSERT_NEAR(J2.elem(11,11), 0, SLOP); ASSERT_NEAR(J2.elem(11,12), 0, SLOP); ASSERT_NEAR(J2.elem(11,13), 0, SLOP); ASSERT_NEAR(J2.elem(11,14), 0, SLOP); ASSERT_NEAR(J2.elem(11,15), 0, SLOP); ASSERT_NEAR(J2.elem(11,16), 0, SLOP); ASSERT_NEAR(J2.elem(11,17), 0, SLOP);
         ASSERT_NEAR(J2.elem(12,0), -1, SLOP); ASSERT_NEAR(J2.elem(12,1), 0, SLOP); ASSERT_NEAR(J2.elem(12,2), 1.22465e-16, SLOP); ASSERT_NEAR(J2.elem(12,3), 1.94259e-14, SLOP); ASSERT_NEAR(J2.elem(12,4), 44.9918, SLOP); ASSERT_NEAR(J2.elem(12,5), 158.625, SLOP); ASSERT_NEAR(J2.elem(12,6), -2.22045e-16, SLOP); ASSERT_NEAR(J2.elem(12,7), 5.55112e-17, SLOP); ASSERT_NEAR(J2.elem(12,8), 1, SLOP); ASSERT_NEAR(J2.elem(12,9), 44.9918, SLOP); ASSERT_NEAR(J2.elem(12,10), -108.625, SLOP); ASSERT_NEAR(J2.elem(12,11), 1.60201e-14, SLOP); ASSERT_NEAR(J2.elem(12,12), -2.22045e-16, SLOP); ASSERT_NEAR(J2.elem(12,13), 2.22045e-16, SLOP); ASSERT_NEAR(J2.elem(12,14), 1, SLOP); ASSERT_NEAR(J2.elem(12,15), 35.3533, SLOP); ASSERT_NEAR(J2.elem(12,16), -42.1324, SLOP); ASSERT_NEAR(J2.elem(12,17), 1.72053e-14, SLOP);
         ASSERT_NEAR(J2.elem(13,0), -0, SLOP); ASSERT_NEAR(J2.elem(13,1), 1, SLOP); ASSERT_NEAR(J2.elem(13,2), 0, SLOP); ASSERT_NEAR(J2.elem(13,3), 44.9918, SLOP); ASSERT_NEAR(J2.elem(13,4), 0, SLOP); ASSERT_NEAR(J2.elem(13,5), 2.4869e-14, SLOP); ASSERT_NEAR(J2.elem(13,6), 1, SLOP); ASSERT_NEAR(J2.elem(13,7), 1.11022e-16, SLOP); ASSERT_NEAR(J2.elem(13,8), 2.22045e-16, SLOP); ASSERT_NEAR(J2.elem(13,9), 9.99018e-15, SLOP); ASSERT_NEAR(J2.elem(13,10), -9.90863e-15, SLOP); ASSERT_NEAR(J2.elem(13,11), -44.9918, SLOP); ASSERT_NEAR(J2.elem(13,12), 0.996195, SLOP); ASSERT_NEAR(J2.elem(13,13), -0.0871557, SLOP); ASSERT_NEAR(J2.elem(13,14), 2.22045e-16, SLOP); ASSERT_NEAR(J2.elem(13,15), 7.85001e-15, SLOP); ASSERT_NEAR(J2.elem(13,16), -9.35528e-15, SLOP); ASSERT_NEAR(J2.elem(13,17), -38.8909, SLOP);
         ASSERT_NEAR(J2.elem(14,0), -1.22465e-16, SLOP); ASSERT_NEAR(J2.elem(14,1), -0, SLOP); ASSERT_NEAR(J2.elem(14,2), -1, SLOP); ASSERT_NEAR(J2.elem(14,3), -158.625, SLOP); ASSERT_NEAR(J2.elem(14,4), 3.03789e-14, SLOP); ASSERT_NEAR(J2.elem(14,5), 1.94259e-14, SLOP); ASSERT_NEAR(J2.elem(14,6), -5.55112e-17, SLOP); ASSERT_NEAR(J2.elem(14,7), 1, SLOP); ASSERT_NEAR(J2.elem(14,8), 0, SLOP); ASSERT_NEAR(J2.elem(14,9), -1.42109e-14, SLOP); ASSERT_NEAR(J2.elem(14,10), -7.88861e-31, SLOP); ASSERT_NEAR(J2.elem(14,11), 108.625, SLOP); ASSERT_NEAR(J2.elem(14,12), 0.0871557, SLOP); ASSERT_NEAR(J2.elem(14,13), 0.996195, SLOP); ASSERT_NEAR(J2.elem(14,14), -2.22045e-16, SLOP); ASSERT_NEAR(J2.elem(14,15), -7.85001e-15, SLOP); ASSERT_NEAR(J2.elem(14,16), 9.35528e-15, SLOP); ASSERT_NEAR(J2.elem(14,17), 38.8909, SLOP);
         ASSERT_NEAR(J2.elem(15,0), 0, SLOP); ASSERT_NEAR(J2.elem(15,1), 0, SLOP); ASSERT_NEAR(J2.elem(15,2), 0, SLOP); ASSERT_NEAR(J2.elem(15,3), -1, SLOP); ASSERT_NEAR(J2.elem(15,4), 0, SLOP); ASSERT_NEAR(J2.elem(15,5), 1.22465e-16, SLOP); ASSERT_NEAR(J2.elem(15,6), 0, SLOP); ASSERT_NEAR(J2.elem(15,7), 0, SLOP); ASSERT_NEAR(J2.elem(15,8), 0, SLOP); ASSERT_NEAR(J2.elem(15,9), -2.22045e-16, SLOP); ASSERT_NEAR(J2.elem(15,10), 5.55112e-17, SLOP); ASSERT_NEAR(J2.elem(15,11), 1, SLOP); ASSERT_NEAR(J2.elem(15,12), 0, SLOP); ASSERT_NEAR(J2.elem(15,13), 0, SLOP); ASSERT_NEAR(J2.elem(15,14), 0, SLOP); ASSERT_NEAR(J2.elem(15,15), -2.22045e-16, SLOP); ASSERT_NEAR(J2.elem(15,16), 2.22045e-16, SLOP); ASSERT_NEAR(J2.elem(15,17), 1, SLOP);
         ASSERT_NEAR(J2.elem(16,0), 0, SLOP); ASSERT_NEAR(J2.elem(16,1), 0, SLOP); ASSERT_NEAR(J2.elem(16,2), 0, SLOP); ASSERT_NEAR(J2.elem(16,3), -0, SLOP); ASSERT_NEAR(J2.elem(16,4), 1, SLOP); ASSERT_NEAR(J2.elem(16,5), 0, SLOP); ASSERT_NEAR(J2.elem(16,6), 0, SLOP); ASSERT_NEAR(J2.elem(16,7), 0, SLOP); ASSERT_NEAR(J2.elem(16,8), 0, SLOP); ASSERT_NEAR(J2.elem(16,9), 1, SLOP); ASSERT_NEAR(J2.elem(16,10), 1.11022e-16, SLOP); ASSERT_NEAR(J2.elem(16,11), 2.22045e-16, SLOP); ASSERT_NEAR(J2.elem(16,12), 0, SLOP); ASSERT_NEAR(J2.elem(16,13), 0, SLOP); ASSERT_NEAR(J2.elem(16,14), 0, SLOP); ASSERT_NEAR(J2.elem(16,15), 0.996195, SLOP); ASSERT_NEAR(J2.elem(16,16), -0.0871557, SLOP); ASSERT_NEAR(J2.elem(16,17), 2.22045e-16, SLOP);
         ASSERT_NEAR(J2.elem(17,0), 0, SLOP); ASSERT_NEAR(J2.elem(17,1), 0, SLOP); ASSERT_NEAR(J2.elem(17,2), 0, SLOP); ASSERT_NEAR(J2.elem(17,3), -1.22465e-16, SLOP); ASSERT_NEAR(J2.elem(17,4), -0, SLOP); ASSERT_NEAR(J2.elem(17,5), -1, SLOP); ASSERT_NEAR(J2.elem(17,6), 0, SLOP); ASSERT_NEAR(J2.elem(17,7), 0, SLOP); ASSERT_NEAR(J2.elem(17,8), 0, SLOP); ASSERT_NEAR(J2.elem(17,9), -5.55112e-17, SLOP); ASSERT_NEAR(J2.elem(17,10), 1, SLOP); ASSERT_NEAR(J2.elem(17,11), 0, SLOP); ASSERT_NEAR(J2.elem(17,12), 0, SLOP); ASSERT_NEAR(J2.elem(17,13), 0, SLOP); ASSERT_NEAR(J2.elem(17,14), 0, SLOP); ASSERT_NEAR(J2.elem(17,15), 0.0871557, SLOP); ASSERT_NEAR(J2.elem(17,16), 0.996195, SLOP); ASSERT_NEAR(J2.elem(17,17), -2.22045e-16, SLOP);

}


int main(int argc, char **argv)
{
::testing::InitGoogleTest(&argc, argv);
    //int argc = 0;
    GraspItApp app(argc, NULL);
    GraspitCore core(argc, NULL);

    app.setMainWidget(core.getMainWindow()->mWindow);


  return RUN_ALL_TESTS();
}

